DROP TABLE APP.USERS;
DROP TABLE APP.EVENTS;
DROP TABLE APP.PARTICIPANT;

CREATE TABLE APP.USERS(
MAIL VARCHAR(30) NOT NULL,
ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
PSEUDO VARCHAR(30) NOT NULL,
PASSWORD VARCHAR(30) NOT NULL,
PRIMARY KEY (ID),
UNIQUE (MAIL)
)

CREATE TABLE APP.EVENTS(
URL VARCHAR(30) NOT NULL,
ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
USERID INTEGER NOT NULL,
NAME VARCHAR(30) NOT NULL,
STARTDATE TIMESTAMP NOT NULL,
ENDDATE TIMESTAMP NOT NULL,
ADDRESS VARCHAR(30) NOT NULL,
PUBLISHED SMALLINT NOT NULL,
PRIMARY KEY (ID),
UNIQUE (URL),
FOREIGN KEY (USERID) REFERENCES APP.USERS(ID)
)

CREATE TABLE APP.PARTICIPANTS(
ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
MAIL VARCHAR(30) NOT NULL,
PSEUDO VARCHAR(30) NOT NULL,
FIRSTNAME VARCHAR(30) NOT NULL,
COMPANY VARCHAR(30) NOT NULL,
PRIMARY KEY (ID),
UNIQUE(MAIL)
)

CREATE TABLE APP.PARTICIPATE(
PARTICIPANTID INTEGER NOT NULL,
EVENTID INTEGER NOT NULL,
PRIMARY KEY (PARTICIPANTID, EVENTID),
FOREIGN KEY (PARTICIPANTID) REFERENCES APP.PARTICIPANTS(ID),
FOREIGN KEY (EVENTID) REFERENCES APP.EVENTS(ID)
)


